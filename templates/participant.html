<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>Espazimos | Participants</title>
    <!-- JavaScript SocketIO -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.3/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous"> -->

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"
        integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js"
        integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous">
        </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <style>
        body {
            background-image: url("https://mir-s3-cdn-cf.behance.net/project_modules/fs/f1d0d572816947.5c2bcd89d519b.gif");
            font-family: 'RobotoDraft', 'Roboto', sans-serif;
            -webkit-font-smoothing: antialiased;
            background-size: cover;
            position: static;
        }

        * {
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        h5 {
            margin: 0px;
            font-size: 1.4em;
            font-weight: 700;
        }

        p {
            font-size: 12px;
            /* color: blue; */
        }

        p.timer {
            font-size: 15px;
            /* color: blue; */
        }

        h1 {
            font-style: inherit;
            color: purple;
        }

        .center {
            height: 100vh;
            width: 100%;
            /* display: flex; */
            justify-content: center;
            align-items: center;
        }

        /* End Non-Essential  */

        .property-card {
            height: 18em;
            width: 14em;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -ms-flex-direction: column;
            flex-direction: column;
            position: relative;
            -webkit-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            -o-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            border-radius: 16px;
            overflow: hidden;
            -webkit-box-shadow: 15px 15px 27px #e1e1e3, -15px -15px 27px #ffffff;
            box-shadow: 15px 15px 27px #e1e1e3, -15px -15px 27px #ffffff;
        }

        /* ^-- The margin bottom is necessary for the drop shadow otherwise it gets clipped in certain cases. */

        /* Top Half of card, image. */

        .property-image {
            height: 6em;
            width: 14em;
            padding: 1em 2em;
            position: absolute;
            top: 0px;
            -webkit-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            -o-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            background-image: url("https://image.freepik.com/free-vector/cartoon-green-jelly-planet-outer-space_107791-1265.jpg");
            background-size: cover;
            background-repeat: no-repeat;
        }

        /* Bottom Card Section */

        .property-description {
            background-color: #FAFAFC;
            height: 12em;
            width: 14em;
            position: absolute;
            bottom: 0em;
            -webkit-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            -o-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            padding: 0.5em 1em;
            text-align: center;
        }

        /* Social Icons */

        .property-social-icons {
            width: 1em;
            height: 1em;
            background-color: black;
            position: absolute;
            bottom: 1em;
            left: 1em;
            -webkit-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            -o-transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            transition: all 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
        }

        /* Property Cards Hover States */

        .property-card:hover .property-description {
            height: 0em;
            padding: 0px 1em;
        }

        .property-card:hover .property-image {
            height: 18em;
        }

        .property-card:hover .property-social-icons {
            background-color: white;
        }

        .property-card:hover .property-social-icons:hover {
            background-color: greenyellow;
            cursor: pointer;
        }

        .score-board {
            text-align: right;
            padding-right: 300px;
            padding-top: 20px;
        }

        .player {
            display: inline-block;
            padding-left: 10px;
        }

        .player h4 {
            font-weight: bold;
        }

        .score-box {
            border: 3px solid black;
            padding: 30px;
            color: #2CB3C9;

        }

        .team-name {
            text-align: left;
            padding-left: 70px;
            padding-top: 30px;
            float: left;

        }

        .team {
            padding-left: 10px;
            top: 0%;
        }

        .team h4 {
            font-weight: bold;
        }

        .name-box {
            border: 3px solid black;
            padding: 30px;
            color: #2CB3C9;
            float: top;

        }

        .team-score {
            display: flex;
            justify-content: space-between;
        }


        .block {

            align-items: right;
        }

        .leaderboard {
            text-align: left;
            padding-left: 0px;
            vertical-align: top;
            float: left;
            position: fixed;
            z-index: 1;
            top: 200px;
            left: 20px;
        }

        * {
            font-family: sans-serif;
        }

        .content-table {
            border-collapse: collapse;
            margin: 0px 0;
            font-size: 0.9em;
            min-width: 320px;
            border-radius: 5px 5px 0 0;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);

        }

        .content-table thead tr {
            background-color: rgb(139, 209, 34);
            color: #ffffff;
            text-align: left;
            font-weight: bold;
        }

        .content-table th,
        .content-table td {
            padding: 12px 15px;
        }

        .content-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        .content-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }

        .content-table tbody tr:last-of-type {
            border-bottom: 2px solid greenyellow;
        }

        .content-table tbody tr.active-row {
            font-weight: bold;
            color: black;
        }
    </style>
</head>


<body>

    <div class="container">

        <div class="row">
            <div class="container">
                <p></p>
            </div>
        </div>
    </div>

    <div class="team-score">
        <div class="team-name">
            <div class="team">
                <h4>Team Name</h4>
                <div class="name-box" id="team_name_box">
                    Team Name
                </div>

            </div>
        </div>

        <div class="score-board">
            <div class="player">
                <h4>Timer</h4>
                <div class="score-box">
                    <p id="timer_box" class="timer"></p>
                </div>
            </div>
        </div>

        <div class="score-board">
            <div class="player">
                <h4>Score Board</h4>
                <div class="score-box" id="my_score_board">
                    0
                </div>
            </div>
        </div>
    </div>
    <div class="block">
        <div class="container mt-5 mb-5">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    ESPAZIMO
                </div>
                <div class="card-body">
                    <div class="container">
                        <pre id="quiz-question">
                    </pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">

            <div class="row">
                <div class="col-sm">
                    <input type="text" id="team_name" placeholder="Team Name" class="form-control mb-3 mt-2" />
                    <input type="hidden" id="my_answer" />
                    <input type="hidden" id="current_question_number" />
                </div>
            </div>

            <div class="row" id="card_base_container">
                <br>
            </div>
        </div>
        <div class="team-score">
            <div class="leaderboard">
                <table class="content-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Team Name</th>
                            <th>Points</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Domenic</td>
                            <td>88,110</td>

                        </tr>
                        <tr class="active-row">
                            <td>2</td>
                            <td>Sally</td>
                            <td>72,400</td>

                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Nick</td>
                            <td>52,300</td>

                        </tr>
                    </tbody>
                </table>
            </div>
        </div>



        <script>

            var random_names = [
                'Stupendous Saturn',
                'Jolly Jupiter',
                'Marvelous Mars',
                'Earthen Star',
                'Space Dream',
                'Rocket Launchers',
                'Space Hellsink',
                'Meteor Bash',
                'Sun Punch',
                'Milky Hellsink',
                'Goal Galaxy',
                'Ideal Astronauts',
                'Biosatellite Blasters',
                'Super Sputnik',
                'Marshy Mars',
                'Deimos Daredevils',
                'Chocolate Charon',
                'Marshmallow Mars'
            ];

            // TODO: This is NOT working as we expected; Please fix this when you get time
            $(document).ready(function () {

                $.getJSON("static/name.json", function (data) {
                    var items = [];

                    var names = data['names'];

                    names.forEach(function (name) {
                        // console.log(name);
                        // random_names.push(name);
                    });

                    // $.each( data, function( key, val ) {
                    //   // items.push( "<li id='" + key + "'>" + val + "</li>" );
                    //   var names = data[]
                    //   console.log();
                    // });

                    // $( "<ul/>", {
                    // "class": "my-new-list",
                    //     html: items.join( "" )
                    // }).appendTo( "body" );


                });

                // get random name and update it
                var random_name = get_random_name();
                //   console.log(random_name);
                $('#team_name').val(random_name);


                $('#team_name_box').html(random_name);

            });



            var socket = io.connect('http://' + document.domain + ':' + location.port);

            socket.on('connect',
                function () {
                    console.log('Client Connected')
                });

            $(document).ready(function () {
                console.log("ready!");


            });

            socket.on('get-question', function (result) {
                // console.log(result);
                // document.getElementById("quiz-question").innerHTML = result.message;

                var quiz_question = result.question;
                $("#quiz-question").html(quiz_question);

                var option_1 = result.option_1;

                // update q_number
                q_number = result['q_number'];
                $('#current_question_number').val(q_number);


                // update the cards
                var option_2 = result.option_2;
                var option_3 = result.option_3;
                var option_4 = result.option_4;
                update_cards(option_1, option_2, option_3, option_4);

                start_timer();
            });

            socket.on('reveal-answers', function (result) {
                // console.log(result);

                var answer = result.answer;
                var team_name = $('#team_name').val();

                // var score  = result.score[team_name];

                var my_answer = $('#my_answer').val();

                var theme_color = 'red';
                if (answer == my_answer) {
                    theme_color = 'green';
                }

                show_vedhavoda_answer_dubba(my_answer, theme_color);

                // update score
                var leaderboard = result.leaderboard
                var score = leaderboard[team_name]
                $('#my_score_board').html(score);

            });

            function update_cards(option_1, option_2, option_3, option_4) {

                // option_1 = $.trim(option_1);
                // option_2 = $.trim(option_2);

                // var card_1_html = '<div class="col-sm">';
                // card_1_html    += '<div class="card" style="">';
                // card_1_html    += '<div class="card-body">';
                // card_1_html    += '<h4 class="card-title">'+option_1+'</h4>';
                // card_1_html    += '<p class="card-text"></p>';
                // card_1_html    += '<a href="#" data-option-index="1" onclick="select_option(\''+option_1+'\');" class="option_select btn btn-primary">Select</a>';
                // card_1_html    += '</div>';
                // card_1_html    += '<!-- <img class="card-img-bottom" src="img_avatar6.png" alt="Card image" style="width:100%"> -->';
                // card_1_html    += '</div>';
                // card_1_html    += '</div>';

                var card_1_html = '<div class="col-sm">';
                card_1_html += '<div class="center">';
                card_1_html += '<div class="property-card">';
                card_1_html += '<a href="#" data-option-index="1" onclick="select_option(\'' + option_1 + '\');">';
                card_1_html += '<div class="property-image">';
                card_1_html += '<div class="property-image-title">';
                card_1_html += '</div>';
                card_1_html += '</div></a>';
                card_1_html += '<div class="property-description">';
                card_1_html += '<h5> ' + option_1 + ' </h5>';
                card_1_html += '<p></p>';
                card_1_html += '</div>';
                card_1_html += '<a href="#">';
                card_1_html += '<div class="property-social-icons">';
                card_1_html += '</div>';
                card_1_html += '</a>';
                card_1_html += '</div>';
                card_1_html += '</div>';
                card_1_html += '</div>';


                var card_2_html = '<div class="col-sm">';
                card_2_html += '<div class="center">';
                card_2_html += '<div class="property-card">';
                card_2_html += '<a href="#" data-option-index="2" onclick="select_option(\'' + option_2 + '\');">';
                card_2_html += '<div class="property-image">';
                card_2_html += '<div class="property-image-title">';
                card_2_html += '</div>';
                card_2_html += '</div></a>';
                card_2_html += '<div class="property-description">';
                card_2_html += '<h5> ' + option_2 + ' </h5>';
                card_2_html += '<p></p>';
                card_2_html += '</div>';
                card_2_html += '<a href="#">';
                card_2_html += '<div class="property-social-icons">';
                card_2_html += '</div>';
                card_2_html += '</a>';
                card_2_html += '</div>';
                card_2_html += '</div>';
                card_2_html += '</div>';


                var card_3_html = '<div class="col-sm">';
                card_3_html += '<div class="center">';
                card_3_html += '<div class="property-card">';
                card_3_html += '<a href="#" data-option-index="3" onclick="select_option(\'' + option_3 + '\');">';
                card_3_html += '<div class="property-image">';
                card_3_html += '<div class="property-image-title">';
                card_3_html += '</div>';
                card_3_html += '</div></a>';
                card_3_html += '<div class="property-description">';
                card_3_html += '<h5> ' + option_3 + ' </h5>';
                card_3_html += '<p></p>';
                card_3_html += '</div>';
                card_3_html += '<a href="#">';
                card_3_html += '<div class="property-social-icons">';
                card_3_html += '</div>';
                card_3_html += '</a>';
                card_3_html += '</div>';
                card_3_html += '</div>';
                card_3_html += '</div>';

                var card_4_html = '<div class="col-sm">';
                card_4_html += '<div class="center">';
                card_4_html += '<div class="property-card">';
                card_4_html += '<a href="#" data-option-index="4" onclick="select_option(\'' + option_4 + '\');">';
                card_4_html += '<div class="property-image">';
                card_4_html += '<div class="property-image-title">';
                card_4_html += '</div>';
                card_4_html += '</div></a>';
                card_4_html += '<div class="property-description">';
                card_4_html += '<h5> ' + option_4 + ' </h5>';
                card_4_html += '<p></p>';
                card_4_html += '</div>';
                card_4_html += '<a href="#">';
                card_4_html += '<div class="property-social-icons">';
                card_4_html += '</div>';
                card_4_html += '</a>';
                card_4_html += '</div>';
                card_4_html += '</div>';
                card_4_html += '</div>';



                var all_cards_content = card_1_html + card_2_html + card_3_html + card_4_html;

                $('div#card_base_container').html(all_cards_content);
            }

            function close_ennoda_dubba() {

                $('div#card_base_container').html('');
            }

            function colog(obj) {
                console.log(obj);
            }

            function select_option(answer) {

                var team_name = $('#team_name').val();
                var q_number = $('#current_question_number').val();

                // colog('option_index : ' + answer);
                socket.emit('submit-answer', {
                    q_number: q_number,
                    team_name: team_name,
                    answer: answer
                });

                close_ennoda_dubba();

                $('#my_answer').val(answer);
            }



            function get_random_name() {
                randomIndex = Math.floor(Math.random() * random_names.length);
                return random_names[randomIndex]
            }

            function show_vedhavoda_answer_dubba(answer, theme_color) {
                // var card_1_html = '<div class="col-sm" style="background-color:'+theme_color+'">';
                // card_1_html    += '<div class="card" style="">';
                // card_1_html    += '<div class="card-body">';
                // card_1_html    += '<h4 class="card-title">'+answer+'</h4>';
                // card_1_html    += '<p class="card-text"></p>';

                // card_1_html    += '</div>';
                // card_1_html    += '<!-- <img class="card-img-bottom" src="img_avatar6.png" alt="Card image" style="width:100%"> -->';
                // card_1_html    += '</div>';
                // card_1_html    += '</div>';

                var card_1_html = '<div class="col-sm">';
                card_1_html += '<div class="center">';
                card_1_html += '<div class="property-card">';
                card_1_html += '<a href="#" data-option-index="1" onclick="select_option(\'' + answer + '\');">';
                card_1_html += '<div class="property-image">';
                card_1_html += '<div class="property-image-title">';
                card_1_html += '</div>';
                card_1_html += '</div></a>';
                card_1_html += '<div class="property-description" style="background-color:' + theme_color + '">';
                card_1_html += '<h5> ' + answer + ' </h5>';
                card_1_html += '<p></p>';
                card_1_html += '</div>';
                card_1_html += '<a href="#">';
                card_1_html += '<div class="property-social-icons">';
                card_1_html += '</div>';
                card_1_html += '</a>';
                card_1_html += '</div>';
                card_1_html += '</div>';
                card_1_html += '</div>';

                // var card_2_html = '<div class="col-sm">';
                // card_2_html    += '<div class="center">';
                // card_2_html    += '<div class="property-card">';
                // card_2_html    += '<a href="#" data-option-index="2" onclick="select_option(\''+answer+'\');">';
                // card_2_html    += '<div class="property-image">';
                // card_2_html    += '<div class="property-image-title">';
                // card_2_html    += '</div>';
                // card_2_html    += '</div></a>';
                // card_2_html    += '<div class="property-description">';
                // card_2_html    += '<h5> '+answer+' </h5>';
                // card_2_html    += '<p></p>';
                // card_2_html    += '</div>';
                // card_2_html    += '<a href="#">';
                // card_2_html    += '<div class="property-social-icons">';
                // card_2_html    += '</div>';
                // card_2_html    += '</a>';
                // card_2_html    += '</div>';
                // card_2_html    += '</div>';
                // card_2_html    += '</div>';


                // var card_3_html = '<div class="col-sm">';
                // card_3_html    += '<div class="center">';
                // card_3_html    += '<div class="property-card">';
                // card_3_html    += '<a href="#" data-option-index="3" onclick="select_option(\''+answer+'\');">';
                // card_3_html    += '<div class="property-image">';
                // card_3_html    += '<div class="property-image-title">';
                // card_3_html    += '</div>';
                // card_3_html    += '</div></a>';
                // card_3_html    += '<div class="property-description">';
                // card_3_html    += '<h5> '+answer+' </h5>';
                // card_3_html    += '<p></p>';
                // card_3_html    += '</div>';
                // card_3_html    += '<a href="#">';
                // card_3_html    += '<div class="property-social-icons">';
                // card_3_html    += '</div>';
                // card_3_html    += '</a>';
                // card_3_html    += '</div>';
                // card_3_html    += '</div>';
                // card_3_html    += '</div>';

                // var card_4_html = '<div class="col-sm">';
                // card_4_html    += '<div class="center">';
                // card_4_html    += '<div class="property-card">';
                // card_4_html    += '<a href="#" data-option-index="4" onclick="select_option(\''+option_4+'\');">';
                // card_4_html    += '<div class="property-image">';
                // card_4_html    += '<div class="property-image-title">';
                // card_4_html    += '</div>';
                // card_4_html    += '</div></a>';
                // card_4_html    += '<div class="property-description">';
                // card_4_html    += '<h5> '+answer+' </h5>';
                // card_4_html    += '<p></p>';
                // card_4_html    += '</div>';
                // card_4_html    += '<a href="#">';
                // card_4_html    += '<div class="property-social-icons">';
                // card_4_html    += '</div>';
                // card_4_html    += '</a>';
                // card_4_html    += '</div>';
                // card_4_html    += '</div>';
                // card_4_html    += '</div>';

                // var answer_cards=card_1_html+card_2_html+card_3_html+card_4_html;
                $('div#card_base_container').html(card_1_html);

            }

            // It doesn't work dynamic html; We have to find a better to way to fix this; We just use select_option method ATM
            // $('a.option_select').click(function(){

            //     // colog('a clicked');

            //     var option_index = $(this).data('option-index');

            //     colog(option_index);

            //     // $('input#quiz_hidden').val(option_index);

            //     socket.emit('submit-answer', {
            //         message: option_index
            //     });

            //     // find the selected card and submit it
            // });

            // $('form#quiz_form').on('submit', function (event) {
            // var option = document.querySelector('input[name="option"]:checked').value;
            // var checkbox_to_update = $("#options").val();

            // colog('ssddsf');

            // var form = $("#options");
            // var option = form.find("input[name=option]:checked").val();
            // // console.log(option);

            // socket.emit('check', {
            //     message: option
            // })
            // })

            // $('#form1').on('submit', function (event) {
            //     // // var option = document.querySelector('input[name="option"]:checked').value;
            //     // // var checkbox_to_update = $("#options").val();
            //     // var form = $("#options");
            //     // var option = form.find("input[name=option]:checked").val();
            //     // // console.log(option);
            //     // socket.emit('check', {
            //     //     message: option
            //     // })
            //     $('#form1').hide();
            // })

            function start_timer() {

                // Set the date we're counting down to
                //var countDownDate = new Date("May 16, 2021 14:59:00").getTime();

                var countDownDate = get_target_time()

                // Update the count down every 1 second
                var x = setInterval(function () {

                    // Get today's date and time
                    var now = new Date().getTime();

                    // Find the distance between now and the count down date
                    var distance = countDownDate - now;

                    // Time calculations for days, hours, minutes and seconds
                    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    // Output the result in an element with id="timer_box"
                    //document.getElementById("timer_box").innerHTML = days + "d " + hours + "h "
                    // + minutes + "m " + seconds + "s ";

                    // document.getElementById("timer_box").innerHTML =  minutes + "m " + seconds + "s ";
                    var timer_content = ""
                    if (minutes < 1) {
                        timer_content = seconds + "s ";
                    }

                    $('#timer_box').html(timer_content);

                    // If the count down is over, write some text 
                    if (distance < 0) {
                        clearInterval(x);
                        // document.getElementById("timer_box").innerHTML = "Time's UP";
                        $('#timer_box').html("Time's UP");
                    }
                }, 1000);
            }
            function get_target_time() {
                var countDownDate = new Date().getTime() + 61000;

                return countDownDate
            }

        </script>
</body>

</html>